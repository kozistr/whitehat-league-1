# WhiteHat League - Demon CTF

## Digital Forensics Write-Up - 출제자 풀이

## Introduce

- Author : 김수영 (SwimBro)
- Field : Digital Forensics
- E-Mail : Alsqudrb13@gmail.com
- Data : 2017-08-31



## Intention

- 기존의 포렌식 문제는 게싱이라는 틀을 깨고 타 CTF와는 다르게 디스크에 남아있는 흔적을 추적하여 분석하는 일련의 과정
- 시스템을 분석해서 법정에서 증거로 인정받을 수 있도록 분석을 진행하는 방법(방식)을 다루게 하려고 시도한 문제 
- 별도의 플래그 인증 형식은 존재하지 않으며
- 분석보고서를 통하서 분석 요구사항을 얼마나 잘 충족시켰나, 얼마나 분석내용이 증거물로 잘 인정될 수 있는가를 따짐.

## Solve
### 2.1	분석보고서를 통하여 데이터가 위, 변조되지 않았음을 증명하여야 한다.

간단하게, 무결성을 유지하라는 것에 대한 질문으로, 해킹을 하는 사람들이 실수하기 쉬운 디지털 포렌식의 무결성 보존 방식과 기술에 대하여 묻는 문제이다.
분석을 시작하기 전 쓰기방지 설정을 진행하고, 해쉬값을 검증 한 후, 해쉬값을 활용해서 해당 내용과 재현의 법칙 등을 이용하여 증명이 가능하다.

### 2.2	최 대리는 데이터를 외부로 유출시키기 위하여 데이터를 암호화 하여 외부로 반출하였는데, 해당 암호화를 해제하기 위한 키를 찾아내어라.

가장먼저 보통 사람들의 특성상 숨기고 싶은 것은 숨김파일 처리하거나, 파일을 삭제하게 되는데, 파일을 “shift+del”키를 사용하거나, 휴지통 비우기, 와이핑 등을 이용하여 삭제하는 것이 아닌 일반적으로 Windows에서 파일을 삭제하게 되면 휴지통에 해당하는 디렉터리로 해당 파일이 이동하게 되어, 보통 사람들이 생각하는 데이터 복구 도구로는 해당 내용을 찾아낼 수 없게 된다.

이를 이용하여, 툴에 의존하는 것이 아닌 직접적으로 Windows-System의 구조에 대한 지식을 갖고 있는지를 질문하는 것이 본 문제의 첫번째 질문이며, 휴지통을 검색하면 해당 첫번째 password를 찾아낼 수 있게 된다.

또한 망가져있는 D Drive를 복구 해 내면, 해당 파티션에는 여러가지의 사진 파일이 있는데, 일반적인 이미지들 사이에서 사람이 적은 파일이 존재함을 알 수 있고, IRC를 이용했던 기록들도 확인 할 수 있다.

따라서 해당 기록들을 종합하면 하나의 파일을 가리키는데 해당 파일이 암호화를 해제하기 위한 두번째 키인 Key File 이다.

따라서 PC에 TrueCrypt가 설치되어 있었음으로 True Crypt를 설치 한 후, 암호화된 파일을 password와 Key File 과 함께 입력 해 주면 암호화 해제가 가능하다.

따라서, password 와 Key File을 발견한 내용에 대한 것들이 분석보고서에 첨부되어 있으면 된다.

### 2.3 유출된 정보를 찾아내어 그 안의 내용 및 해당 파일을 보고서에 첨부하여라

휴지통에서 password를 찾을 때 플래그에 집중하여 password 만 찾는 것이 아닌, 다른 도움이 될 만한 증거파일이 무엇이 있을 까 하고 찾아보았다면, 쉽게 찾을 수 있으며, 분석도구에서 무엇인지 알 수 없는 파일로 분류되는 파일중에 존재하여, 툴을 이용하여서도 쉽게 찾아낼 수 있다.

### 2.4 최 대리가 근무하였던 모 청소년 센터에서는 최대리가 퇴사하기 얼마 전 최 대리의 PC 시간이 이상하게 설정되어 있는 것이 내부 장비에서 발견되었다고 증언하였으나, 최 대리는 그런일이 없고 정상적으로 문서작업 및 웹 서핑에만 PC를 이용하였다고 증언하고 있다.

최 대리의 PC에서 시스템의 시간정보가 변경된 이력이 있다는 것을 증명하여라.

시간정보가 변경된 이력은 두가지 방법을 사용하여 확인 할 수 있는데, 첫째는 프리패치를 이용하여, 시간 관련 dll 등을 로드 해 온 기록을 확인하여 추정하는 방법이며, 두번쨰는 이벤트 로그를 분석하여, 아래 사진과 같이 내용을 확인하는 방법이 있습니다.

![](https://github.com/kozistr/whitehat-league-1/blob/master/image/df-1.png)

따라서, 위 사진과 같이 이벤트 로그를 이용하여 PC에서 사용자가 임의로 시간을 변조한 기록을 확인 할 수 있다.